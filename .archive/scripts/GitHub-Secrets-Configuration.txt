# GitHub Secrets Configuration
# Repository: AHartTN/Hartonomous-Sandbox

## Repository Secrets (Settings > Secrets and variables > Actions > Repository secrets)

AZURE_SUBSCRIPTION_ID = ed614e1a-7d8b-4608-90c8-66e86c37080b
AZURE_TENANT_ID = 6c9c44c4-f04b-4b5f-bea0-f1069179799c
SQL_SERVER = HART-DESKTOP
SQL_DATABASE = Hartonomous

## Environment Secrets (Settings > Secrets and variables > Actions > Environments)

### Environment: DEVELOPMENT
Create environment in GitHub: Settings > Environments > New environment > "DEVELOPMENT"

For production environment, configure:
- Required reviewers: Add team/individuals for approval
- Deployment branches: main only

Secrets for this environment:
AZURE_CLIENT_ID = 66a37c0f-5666-450b-b61f-c9e33b56115e

### Environment: STAGING
Create environment in GitHub: Settings > Environments > New environment > "STAGING"

For production environment, configure:
- Required reviewers: Add team/individuals for approval
- Deployment branches: main only

Secrets for this environment:
AZURE_CLIENT_ID = f05370b1-d09f-4085-bd04-ac028c28b7f8

### Environment: PRODUCTION
Create environment in GitHub: Settings > Environments > New environment > "PRODUCTION"

For production environment, configure:
- Required reviewers: Add team/individuals for approval
- Deployment branches: main only

Secrets for this environment:
AZURE_CLIENT_ID = 48a904b7-f070-407d-abab-1b71a3c049a9

## Verification Commands (Run from GitHub Actions workflow context)

# These commands work ONLY within GitHub Actions workflow execution.
# The OIDC token is provided automatically by GitHub to the workflow.

### Workflow YAML example for authentication test:
`yaml
- name: Azure Login
  uses: azure/login@v2
  with:
    client-id: ${{ secrets.AZURE_CLIENT_ID }}
    tenant-id: ${{ secrets.AZURE_TENANT_ID }}
    subscription-id: ${{ secrets.AZURE_SUBSCRIPTION_ID }}

- name: Test SQL Connection
  run: |
    $token = az account get-access-token --resource https://database.windows.net/ --query accessToken -o tsv
    Invoke-Sqlcmd -ServerInstance ${{ secrets.SQL_SERVER }} `
      -Database ${{ secrets.SQL_DATABASE }} `
      -AccessToken $token `
      -Query "SELECT SUSER_NAME() AS [Authenticated As], DB_NAME() AS [Database]"
`

### Local testing (requires your own Azure login):
`powershell
# Login with your account
az login

# Get token and test SQL connection
$token = az account get-access-token --resource https://database.windows.net/ --query accessToken -o tsv
Invoke-Sqlcmd -ServerInstance HART-DESKTOP `
  -Database  `
  -AccessToken $token `
  -Query "SELECT SUSER_NAME() AS [Authenticated As], @@VERSION AS [SQL Version]"
`

