-- Test Semantic Search Procedure
USE Hartonomous;
GO

PRINT 'Testing semantic search with AI-related query vector...';
GO

-- Query vector with 768 dimensions (matching sp_SemanticSearch signature)
-- This is a sample vector - in production this would come from an embedding model
-- Using implicit cast from JSON array to VECTOR
DECLARE @ai_query VECTOR(768) = JSON_ARRAY(
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001,
    0.001,0.001,0.001,0.001,0.001,0.001,0.001,0.001
);

EXEC dbo.sp_SemanticSearch 
    @query_embedding = @ai_query, 
    @query_dimension = 768,
    @top_k = 3;
GO

PRINT '';
PRINT 'Testing semantic search with Database-related query vector...';
GO

-- Another 768-dimension query vector with slightly different values
DECLARE @db_query VECTOR(768) = JSON_ARRAY(
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002,
    0.002,0.002,0.002,0.002,0.002,0.002,0.002,0.002
);

EXEC dbo.sp_SemanticSearch 
    @query_embedding = @db_query, 
    @query_dimension = 768,
    @top_k = 3;
GO

PRINT '';
PRINT 'Checking inference logs...';
GO

SELECT TOP 5
	InferenceId,
	TaskType,
	ModelsUsed,
	TotalDurationMs,
	OutputMetadata,
	RequestTimestamp
FROM dbo.InferenceRequests
ORDER BY InferenceId DESC;
GO

